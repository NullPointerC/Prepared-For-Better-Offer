### hashmap的数据插入原理是怎么样的？

![image-20220309202946733](https://gitee.com/cao_ziqiang/img/raw/master/20220309202946.png)

如果链表长度大于8，转化为红黑树；

如果红黑树中节点个数小于6，转回链表；

以上条件都要基于数组的长度大于64时，才会进行转化；

### HashMap怎么设定初始容量大小?

一般如果new HashMap()不传值，默认大小是16，负载因子是0.75。

如果自己传入初始大小k，初始化大小为大于k的2的整数次方，例如如果传10，大小为16。

![image-20220309210013740](https://gitee.com/cao_ziqiang/img/raw/master/20220309210013.png)

在1.8中，传入的初始容量cap，真实容量会被设置为距离cap最近的2的整数次方。

在1.7中，传入的初始容量cap，真实容量会被设置为cap。

### HashMap的哈希函数设计是怎样的?

hash函数是先拿到key 的hashcode，是一个32位的int值，然后让hashcode的高16位和低16位进行异或操作。

原因：

①.尽可能降低hash碰撞；

②.低位掩码就是利用高位掩码替换低位掩码，也称为扰动函数；



